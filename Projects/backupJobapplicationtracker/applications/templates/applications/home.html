<!DOCTYPE html>
<html>
<head>
    <title>Job Application Tracker</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body class="container mt-4">

    <h2 class="mb-4 text-primary">üìå Job Application Tracker</h2>

    <!-- DASHBOARD CARDS -->
    <div class="row text-center mb-4">
        <div class="col">
            <div class="p-3 bg-secondary text-white rounded">Total: {{total}}</div>
        </div>
        <div class="col">
            <div class="p-3 bg-info text-dark rounded">Interview: {{interview}}</div>
        </div>
        <div class="col">
            <div class="p-3 bg-warning text-dark rounded">Applied: {{applied}}</div>
        </div>
        <div class="col">
            <div class="p-3 bg-danger text-white rounded">Rejected: {{rejected}}</div>
        </div>
        <div class="col">
            <div class="p-3 bg-success text-white rounded">Selected: {{selected}}</div>
        </div>
    </div>


    <!-- SEARCH, SORT & FILTER -->
    <div class="row mb-3">

        <!-- SEARCH -->
        <div class="col-md-5">
            <form method="get" class="d-flex">
                <input type="text" name="search" class="form-control me-2"
                       placeholder="Search by company or role" value="{{request.GET.search}}">
                <button class="btn btn-primary">Search</button>
            </form>
        </div>

        <!-- SORT -->
        <div class="col-md-3">
            <form method="get">
                <select name="sort" class="form-select" onchange="this.form.submit()">
                    <option value="">Sort By</option>
                    <option value="company">Company</option>
                    <option value="role">Role</option>
                    <option value="date">Date</option>
                    <option value="status">Status</option>
                </select>
            </form>
        </div>

        <!-- FILTER -->
        <div class="col-md-3">
            <form method="get">
                <select name="status" class="form-select" onchange="this.form.submit()">
                    <option value="">Filter Status</option>
                    <option value="Applied">Applied</option>
                    <option value="Interview Scheduled">Interview Scheduled</option>
                    <option value="Rejected">Rejected</option>
                    <option value="Selected">Selected</option>
                </select>
            </form>
        </div>

        <!-- EXPORT CSV -->
        <div class="col-md-1">
            <a href="{% url 'export' %}" class="btn btn-outline-dark">üìÅ</a>
        </div>

    </div>


    <!-- ADD NEW BUTTON -->
    <div class="mb-3">
        <a href="{% url 'add' %}" class="btn btn-success">+ Add New Application</a>
    </div>


    <!-- TABLE -->
    <table class="table table-bordered table-striped">
        <tr>
            <th>Company</th>
            <th>Role</th>
            <th>Status</th>
            <th>Applied Date</th>
            <th>Actions</th>
        </tr>

        {% for a in apps %}
        <tr>
            <td>{{a.company}}</td>
            <td>{{a.role}}</td>

            <td>
                {% if a.status == 'Applied' %}
                    <span class="badge bg-warning">{{a.status}}</span>
                {% elif a.status == 'Interview Scheduled' %}
                    <span class="badge bg-info">{{a.status}}</span>
                {% elif a.status == 'Rejected' %}
                    <span class="badge bg-danger">{{a.status}}</span>
                {% else %}
                    <span class="badge bg-success">{{a.status}}</span>
                {% endif %}
            </td>

            <td>{{a.applied_date}}</td>

            <td>
                <a href="{% url 'edit' a.id %}" class="btn btn-warning btn-sm">Edit</a>
                <a href="{% url 'delete' a.id %}" class="btn btn-danger btn-sm">Delete</a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" class="text-center text-muted">No applications found</td>
        </tr>
        {% endfor %}
    </table>

</body>
</html>
